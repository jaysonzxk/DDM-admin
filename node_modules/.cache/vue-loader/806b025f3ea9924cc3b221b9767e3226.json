{"remainingRequest":"/Users/mac/Desktop/DDM-admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/mac/Desktop/DDM-admin/src/views/admin/system/message/Mymessage.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/mac/Desktop/DDM-admin/src/views/admin/system/message/Mymessage.vue","mtime":1702065174000},{"path":"/Users/mac/Desktop/DDM-admin/node_modules/cache-loader/dist/cjs.js","mtime":1703645363792},{"path":"/Users/mac/Desktop/DDM-admin/node_modules/babel-loader/lib/index.js","mtime":1703645364828},{"path":"/Users/mac/Desktop/DDM-admin/node_modules/cache-loader/dist/cjs.js","mtime":1703645363792},{"path":"/Users/mac/Desktop/DDM-admin/node_modules/vue-loader/lib/index.js","mtime":1703645365038}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IHVwZGF0ZUlzUmVhZCwgdXNlck1lc3NhZ2UgfSBmcm9tICJAL2FwaS9hZG1pbi9zeXN0ZW0vbWVzc2FnZSI7CmltcG9ydCBzdG9yZSBmcm9tICJAL3N0b3JlIjsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiTXltZXNzYWdlIiwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgLy8g5p+l6K+i6YCa55+lCiAgICAgIHF1ZXJ5UGFyYW1zOiB7CiAgICAgICAgcGFnZU51bTogMSwKICAgICAgICBwYWdlU2l6ZTogMTAKICAgICAgfSwKICAgICAgbWVzc2FnZUxpc3Q6IFtdLAogICAgICAvLyDlt7Lor7vpgJrnn6UKICAgICAgY291bnRSZWFkZWQ6IDAsCiAgICAgIG1lc3NhZ2VSZWFkZWRMaXN0OiBbXSwKICAgICAgLy8g5pyq6K+75raI5oGv5YiX6KGoCiAgICAgIG1lc3NhZ2VVbnJlYWRMaXN0OiBbXSwKICAgICAgY291bnRVbnJlYWQ6IDAsCiAgICAgIGJhZGdlVHlwZTogImRhbmdlciIsCiAgICAgIC8vIOmAieS4reafpeivouWQjueahOivpue7huS/oeaBrwogICAgICBzaG93aW5nTXNnSXRlbToge30KICAgIH07CiAgfSwKICBjcmVhdGVkKCkgewogICAgdGhpcy5nZXRMaXN0KCk7CiAgfSwKICBtZXRob2RzOiB7CiAgICAvKiog5p+l6K+i6YCa55+l5YiX6KGoICovCiAgICBnZXRMaXN0KCkgewogICAgICAvLyDlt7Lor7vpgJrnn6XliJfooagKICAgICAgdXNlck1lc3NhZ2UodGhpcy5hZGREYXRlUmFuZ2UoeyAuLi50aGlzLnF1ZXJ5UGFyYW1zLCBpc19yZWFkOiAiVHJ1ZSIgfSkpLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgIHRoaXMubWVzc2FnZVJlYWRlZExpc3QgPSByZXNwb25zZS5kYXRhLnJlc3VsdHM7CiAgICAgICAgdGhpcy5jb3VudFJlYWRlZCA9IHJlc3BvbnNlLmRhdGEuY291bnQ7CiAgICAgIH0KICAgICAgKTsKICAgICAgLy8g5pyq6K+76YCa55+l5YiX6KGoCiAgICAgIHVzZXJNZXNzYWdlKHRoaXMuYWRkRGF0ZVJhbmdlKHsgLi4udGhpcy5xdWVyeVBhcmFtcywgaXNfcmVhZDogIkZhbHNlIiB9KSkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgdGhpcy5tZXNzYWdlVW5yZWFkTGlzdCA9IHJlc3BvbnNlLmRhdGEucmVzdWx0czsKICAgICAgICB0aGlzLmNvdW50VW5yZWFkID0gcmVzcG9uc2UuZGF0YS5jb3VudDsKICAgICAgICB0aGlzLm1lc3NhZ2VMaXN0ID0gdGhpcy5tZXNzYWdlVW5yZWFkTGlzdDsKICAgICAgfQogICAgICApOwogICAgfSwKICAgIGhhbmRsZVNlbGVjdChrZXksIGtleVBhdGgpIHsKICAgICAgdGhpcy5tZXNzYWdlTGlzdCA9IGtleVswXSA9PT0gIjEiID8gdGhpcy5tZXNzYWdlVW5yZWFkTGlzdCA6IHRoaXMubWVzc2FnZVJlYWRlZExpc3Q7CiAgICAgIHRoaXMuYmFkZ2VUeXBlID0ga2V5WzBdID09PSAiMSIgPyAiZGFuZ2VyIiA6ICJpbmZvIjsKICAgIH0sCiAgICAvLyDpgJrnn6XliJfooajmv4DmtLvlkI4KICAgIGhhbmRsZUxpc3RTZWxlY3Qoa2V5LCBrZXlQYXRoKSB7CiAgICAgIHRoaXMuc2hvd2luZ01zZ0l0ZW0gPSB0aGlzLm1lc3NhZ2VMaXN0W2tleVswXV07CiAgICAgIC8vIOS/ruaUuemAmuefpeafpeivoueKtuaAgQogICAgICBpZiAodGhpcy5iYWRnZVR5cGUgPT09ICJkYW5nZXIiKSB7CiAgICAgICAgdXBkYXRlSXNSZWFkKHRoaXMuc2hvd2luZ01zZ0l0ZW0pLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgICAgaWYgKHJlc3BvbnNlLmNvZGUgPT09IDIwMCkgewogICAgICAgICAgICBzdG9yZS5jb21taXQoIlNFVF9VTlJFQURfTVNHX0NPVU5UIiwgc3RvcmUuZ2V0dGVycy51bnJlYWRfbXNnX2NvdW50IC0gMSk7CiAgICAgICAgICAgIHRoaXMub3BlbiA9IGZhbHNlOwogICAgICAgICAgICB0aGlzLmdldExpc3QoKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQogICAgfQogIH0KfTsK"},{"version":3,"sources":["Mymessage.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmDA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Mymessage.vue","sourceRoot":"src/views/admin/system/message","sourcesContent":["<template>\n  <div class=\"app-container\">\n    <el-card shadow=\"never\">\n      <div class=\"message-page-con message-category-con\">\n        <el-menu\n          default-active=\"1\"\n          class=\"el-menu-vertical-demo\"\n          @select=\"handleSelect\"\n        >\n          <el-menu-item index=\"1\">\n            <template slot=\"title\">\n              <span class=\"category-title\">未读消息</span>\n              <el-badge style=\"margin-bottom: 3px\" :value=\"countUnread\" :hidden=\"countUnread===0\" />\n            </template>\n          </el-menu-item>\n          <el-menu-item index=\"2\">\n            <span class=\"category-title\">已读消息</span>\n            <el-badge style=\"margin-bottom: 3px\" type=\"info\" :value=\"countReaded\" />\n          </el-menu-item>\n        </el-menu>\n      </div>\n      <div class=\"message-page-con message-list-con\">\n        <el-menu\n          default-active=\"2\"\n          class=\"el-menu-vertical-demo\"\n          @select=\"handleListSelect\"\n        >\n          <el-menu-item v-for=\"(item,index) in messageList\" :key=\"index\" :index=\"index.toString()\">\n            <template slot=\"title\">\n              <div style=\"line-height: 10px!important;height: 20px;\">\n                <p class=\"msg-title\">{{ item.title }}</p>\n                <el-badge is-dot class=\"item\" :type=\"badgeType\" />\n                {{ item.create_datetime }}\n\n              </div>\n            </template>\n          </el-menu-item>\n        </el-menu>\n      </div>\n      <div class=\"message-page-con message-view-con\">\n        <div class=\"message-view-header\">\n          <h2 class=\"message-view-title\">{{ showingMsgItem.title }}</h2>\n          <time class=\"message-view-time\">{{ showingMsgItem.create_datetime }}</time>\n        </div>\n        <div v-html=\"showingMsgItem.content\" />\n      </div>\n    </el-card>\n  </div>\n</template>\n\n<script>\nimport { updateIsRead, userMessage } from \"@/api/admin/system/message\";\nimport store from \"@/store\";\n\nexport default {\n  name: \"Mymessage\",\n  data() {\n    return {\n      // 查询通知\n      queryParams: {\n        pageNum: 1,\n        pageSize: 10\n      },\n      messageList: [],\n      // 已读通知\n      countReaded: 0,\n      messageReadedList: [],\n      // 未读消息列表\n      messageUnreadList: [],\n      countUnread: 0,\n      badgeType: \"danger\",\n      // 选中查询后的详细信息\n      showingMsgItem: {}\n    };\n  },\n  created() {\n    this.getList();\n  },\n  methods: {\n    /** 查询通知列表 */\n    getList() {\n      // 已读通知列表\n      userMessage(this.addDateRange({ ...this.queryParams, is_read: \"True\" })).then(response => {\n        this.messageReadedList = response.data.results;\n        this.countReaded = response.data.count;\n      }\n      );\n      // 未读通知列表\n      userMessage(this.addDateRange({ ...this.queryParams, is_read: \"False\" })).then(response => {\n        this.messageUnreadList = response.data.results;\n        this.countUnread = response.data.count;\n        this.messageList = this.messageUnreadList;\n      }\n      );\n    },\n    handleSelect(key, keyPath) {\n      this.messageList = key[0] === \"1\" ? this.messageUnreadList : this.messageReadedList;\n      this.badgeType = key[0] === \"1\" ? \"danger\" : \"info\";\n    },\n    // 通知列表激活后\n    handleListSelect(key, keyPath) {\n      this.showingMsgItem = this.messageList[key[0]];\n      // 修改通知查询状态\n      if (this.badgeType === \"danger\") {\n        updateIsRead(this.showingMsgItem).then(response => {\n          if (response.code === 200) {\n            store.commit(\"SET_UNREAD_MSG_COUNT\", store.getters.unread_msg_count - 1);\n            this.open = false;\n            this.getList();\n          }\n        });\n      }\n    }\n  }\n};\n</script>\n<style scoped>\n  .app-container {\n    background-color: #f5f7f9;\n  }\n\n  .message-category-con {\n    border-right: 1px solid #e6e6e6;\n    width: 200px;\n  }\n\n  .message-page-con {\n    height: calc(100vh - 176px);\n    display: inline-block;\n    vertical-align: top;\n    position: relative;\n  }\n\n  .category-title {\n    display: inline-block;\n    width: 65px;\n  }\n\n  .message-list-con {\n    border-right: 1px solid #e6e6e6;\n    width: 230px;\n  }\n\n  .msg-title {\n    word-break: break-all;\n    white-space: normal;\n    line-height: 15px;\n    color: rgb(170, 169, 169);\n  }\n\n  .message-list-con .el-menu-item {\n    height: 80px;\n    padding-top: 5px;\n  }\n\n  .item {\n    margin-right: 10px;\n    margin-bottom: 5px;\n  }\n\n  .message-view-con {\n    position: absolute;\n    left: 486px;\n    top: 16px;\n    right: 16px;\n    bottom: 16px;\n    overflow: auto;\n    padding: 12px 20px 0;\n\n  }\n\n  .message-view-header {\n    margin-bottom: 20px;\n\n  }\n\n  .message-view-title {\n    display: inline-block;\n  }\n\n  .message-view-time {\n    margin-left: 20px;\n  }\n</style>\n"]}]}