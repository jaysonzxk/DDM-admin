{"remainingRequest":"/Users/jayson/Desktop/work/DDM-admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/jayson/Desktop/work/DDM-admin/src/views/admin/monitor/server/components/InstrumentBoard.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/jayson/Desktop/work/DDM-admin/src/views/admin/monitor/server/components/InstrumentBoard.vue","mtime":1720245294021},{"path":"/Users/jayson/Desktop/work/DDM-admin/node_modules/cache-loader/dist/cjs.js","mtime":1720245288376},{"path":"/Users/jayson/Desktop/work/DDM-admin/node_modules/babel-loader/lib/index.js","mtime":1720245285342},{"path":"/Users/jayson/Desktop/work/DDM-admin/node_modules/cache-loader/dist/cjs.js","mtime":1720245288376},{"path":"/Users/jayson/Desktop/work/DDM-admin/node_modules/vue-loader/lib/index.js","mtime":1720245293567}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBWdWVUeXBlcyBmcm9tICJ2dWUtdHlwZXMiOwovLyDlvJXlhaXln7rmnKzmqKHmnb8s5oyJ6ZyA5Yqg6L29CmNvbnN0IGVjaGFydHMgPSByZXF1aXJlKCJlY2hhcnRzL2xpYi9lY2hhcnRzIik7CnJlcXVpcmUoImVjaGFydHMvbGliL2NoYXJ0L2dhdWdlIik7CgovLyDku6rooajnm5jpopzoibLojIPlm7QKY29uc3QgTk9STUFMX0NPTE9SID0gewogIGNvbG9yOiAiIzI4QkNGRSIsCiAgaXRlbUNvbG9yOiBbIiMyNWJmZmYiLCAiIzUyODRkZSIsICIjMmE5NWY5Il0KfTsKY29uc3QgV0FSTklOR19DT0xPUiA9IHsKICBjb2xvcjogIiNlNmEyM2MiLAogIGl0ZW1Db2xvcjogWyIjZTZhMjNjIiwgIiNjYzhiMWQiLCAiI2ZmYWYxOCJdCn07CmNvbnN0IERBTkdFUl9DT0xPUiA9IHsKICBjb2xvcjogIiNGNTZDNkMiLAogIGl0ZW1Db2xvcjogWyIjZmQ2NjZkIiwgIiNjZjE3MTciLCAiI2IzMTIxMiJdCn07CgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIkluc3RydW1lbnRCb2FyZCIsCiAgcHJvcHM6IHsKICAgIC8vIOe7hOS7tmtleQogICAgcmluZ0dyYXBoS2V5OiBWdWVUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZCwKICAgIC8vIOS4iuagh+mimAogICAgc2hvd1RvcFRpdGxlOiBWdWVUeXBlcy5ib29sLmRlZihmYWxzZSksCiAgICAvLyDkuIvmoIfpopgKICAgIHNob3dTdWJUaXRsZTogVnVlVHlwZXMuYm9vbC5kZWYoZmFsc2UpLAogICAgLy8gdG9wIHRpdGxlIOmFjee9ruaYoOWwhAogICAgdG9wVGl0bGVLZXlUb05hbWVNYXBwaW5nOiBWdWVUeXBlcy5vYmplY3QuZGVmKHsKICAgICAgY3B1OiAiQ1BV5L2/55So546HIiwKICAgICAgbWVtb3J5OiAi5YaF5a2Y5L2/55So546HIgogICAgfSksCiAgICBpbnN0cnVtZW50Qm9hcmREYXRhOiBWdWVUeXBlcy5hbnkuaXNSZXF1aXJlZAogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIC8vIOW9k+WJjeaYvuekuueahOaVsOaNrgogICAgICBjdXJyZW50SW5zdHJ1bWVudEJvYXJkRGF0YToge30KICAgIH07CiAgfSwKICBjb21wdXRlZDogewogICAgLy8g5Luq6KGo55uY5piv5ZCm5a2Y5Zyo5aSa5Liq5pWw5o2uCiAgICBoYXZlTXVsdGlwbGVEYXRhKCkgewogICAgICByZXR1cm4gdGhpcy5pbnN0cnVtZW50Qm9hcmREYXRhIGluc3RhbmNlb2YgQXJyYXkgJiYgdGhpcy5pbnN0cnVtZW50Qm9hcmREYXRhLmxlbmd0aCA+IDA7CiAgICB9LAogICAgLy8g5L2/55So546HCiAgICByaW5nUmF0ZSgpIHsKICAgICAgbGV0IHJpbmdSYXRlID0gdGhpcy5jdXJyZW50SW5zdHJ1bWVudEJvYXJkRGF0YS5yYXRlOwogICAgICByaW5nUmF0ZSA9IHJpbmdSYXRlIDwgMSA/IHJpbmdSYXRlICogMTAwIDogcmluZ1JhdGU7CiAgICAgIHJldHVybiBwYXJzZUZsb2F0KHJpbmdSYXRlLnRvRml4ZWQoNCkpOwogICAgfSwKICAgIC8vIOS7quihqOebmGlkCiAgICByaW5nR3JhcGhJZCgpIHsKICAgICAgcmV0dXJuIGAke3RoaXMucmluZ0dyYXBoS2V5fVVzaW5nUmF0ZWA7CiAgICB9LAogICAgLy8g5LiK5pa55qCH6aKYCiAgICB0b3BUaXRsZSgpIHsKICAgICAgcmV0dXJuIHRoaXMuY3VycmVudEluc3RydW1lbnRCb2FyZERhdGFbImRpcl9uYW1lIl0gfHwgdGhpcy50b3BUaXRsZUtleVRvTmFtZU1hcHBpbmdbdGhpcy5yaW5nR3JhcGhLZXldIHx8IHRoaXMucmluZ0dyYXBoS2V5OwogICAgfSwKICAgIC8vIOS4i+aWueagh+mimAogICAgc3ViVGl0bGUoKSB7CiAgICAgIGNvbnN0IHVzZWQgPSB0aGlzLmN1cnJlbnRJbnN0cnVtZW50Qm9hcmREYXRhWyJ1c2VkIl0gPyB0aGlzLmN1cnJlbnRJbnN0cnVtZW50Qm9hcmREYXRhWyJ1c2VkIl0gKyAiLyIgOiAiIjsKICAgICAgY29uc3QgdG90YWwgPSB0aGlzLmN1cnJlbnRJbnN0cnVtZW50Qm9hcmREYXRhWyJ0b3RhbCJdID8gdGhpcy5jdXJyZW50SW5zdHJ1bWVudEJvYXJkRGF0YVsidG90YWwiXSA6ICIiOwogICAgICBjb25zdCB1bml0ID0gdGhpcy5jdXJyZW50SW5zdHJ1bWVudEJvYXJkRGF0YVsidW5pdCJdID8gYCAoJHt0aGlzLmN1cnJlbnRJbnN0cnVtZW50Qm9hcmREYXRhWyJ1bml0Il19KWAgOiAiIjsKICAgICAgY29uc3QgY29udGVudCA9IGAke3VzZWR9JHt0b3RhbH0ke3VuaXR9IGA7CiAgICAgIGNvbnN0IHRpdGxlID0gKHRoaXMuY3VycmVudEluc3RydW1lbnRCb2FyZERhdGFbInVzZWQiXSA/ICLlt7LnlKgvIiA6ICIiKSArICLmgLvph48o5Y2V5L2NKSI7CiAgICAgIHJldHVybiB7IGNvbnRlbnQsIHRpdGxlIH07CiAgICB9LAogICAgLy8g5L2/55So546H5qC35byP6YWN572uCiAgICB1c2luZ1JhdGVTdHlsZSgpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBmb250U2l6ZTogMTgsCiAgICAgICAgLi4udGhpcy5nZXRDaXJjbGVDb2xvcih0aGlzLnJpbmdSYXRlKQogICAgICB9OwogICAgfQogIH0sCiAgbW91bnRlZCgpIHsKICAgIGlmICh0aGlzLmhhdmVNdWx0aXBsZURhdGEpIHsKICAgICAgdGhpcy5jdXJyZW50SW5zdHJ1bWVudEJvYXJkRGF0YSA9IHRoaXMuaW5zdHJ1bWVudEJvYXJkRGF0YVswXTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuY3VycmVudEluc3RydW1lbnRCb2FyZERhdGEgPSB0aGlzLmluc3RydW1lbnRCb2FyZERhdGE7CiAgICB9CiAgICB0aGlzLmRyYXdCYXIoKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGRyYXdCYXIoKSB7CiAgICAgIGNvbnN0IGN1cnJlbnRSYXRlID0gW3RoaXMucmluZ1JhdGVdOwogICAgICAvLyDln7rkuo5kb23vvIzliJ3lp4vljJZlY2hhcnRz5a6e5L6LCiAgICAgIGNvbnN0IFJpbmdHcmFwaCA9IGVjaGFydHMuaW5pdChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0aGlzLnJpbmdHcmFwaElkKSk7CgogICAgICBjb25zdCBvcHRpb24gPSB7CiAgICAgICAgdGl0bGU6IHsKICAgICAgICAgIHRleHQ6IGN1cnJlbnRSYXRlICsgIiUiLAogICAgICAgICAgdGV4dFN0eWxlOiB0aGlzLnVzaW5nUmF0ZVN0eWxlLAogICAgICAgICAgaXRlbUdhcDogMTAsCiAgICAgICAgICBsZWZ0OiAiY2VudGVyIiwKICAgICAgICAgIHRvcDogIjQ1JSIKICAgICAgICB9LAogICAgICAgIGFuZ2xlQXhpczogewogICAgICAgICAgbWF4OiAxMDAsCiAgICAgICAgICBjbG9ja3dpc2U6IHRydWUsIC8vIOmAhuaXtumSiAogICAgICAgICAgLy8g6ZqQ6JeP5Yi75bqm57q/CiAgICAgICAgICBzaG93OiBmYWxzZQogICAgICAgIH0sCiAgICAgICAgcmFkaXVzQXhpczogewogICAgICAgICAgdHlwZTogImNhdGVnb3J5IiwKICAgICAgICAgIHNob3c6IHRydWUsCiAgICAgICAgICBheGlzTGFiZWw6IHsKICAgICAgICAgICAgc2hvdzogZmFsc2UKICAgICAgICAgIH0sCiAgICAgICAgICBheGlzTGluZTogewogICAgICAgICAgICBzaG93OiBmYWxzZQogICAgICAgICAgfSwKICAgICAgICAgIGF4aXNUaWNrOiB7CiAgICAgICAgICAgIHNob3c6IGZhbHNlCiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBwb2xhcjogewogICAgICAgICAgY2VudGVyOiBbIjUwJSIsICI1MCUiXSwgLy8g5Z2Q5qCH5Lit5b+D5L2N572uCiAgICAgICAgICByYWRpdXM6ICIxMDAlIiAvLyDlm77lvaLlpKflsI8KICAgICAgICB9LAogICAgICAgIHNlcmllczogW3sKICAgICAgICAgIHR5cGU6ICJiYXIiLAogICAgICAgICAgZGF0YTogY3VycmVudFJhdGUsCiAgICAgICAgICBzaG93QmFja2dyb3VuZDogdHJ1ZSwKICAgICAgICAgIGJhY2tncm91bmRTdHlsZTogewogICAgICAgICAgICBjb2xvcjogIiNCREVCRkYiIC8vIOW6leWciOminOiJsgogICAgICAgICAgfSwKICAgICAgICAgIGNvb3JkaW5hdGVTeXN0ZW06ICJwb2xhciIsCiAgICAgICAgICByb3VuZENhcDogdHJ1ZSwKICAgICAgICAgIGJhcldpZHRoOiAxNSwKICAgICAgICAgIGl0ZW1TdHlsZTogewogICAgICAgICAgICBub3JtYWw6IHsKICAgICAgICAgICAgICBvcGFjaXR5OiAxLAogICAgICAgICAgICAgIGNvbG9yOiBuZXcgZWNoYXJ0cy5ncmFwaGljLkxpbmVhckdyYWRpZW50KDAsIDAsIDAsIDEsIFt7CiAgICAgICAgICAgICAgICBvZmZzZXQ6IDAsCiAgICAgICAgICAgICAgICBjb2xvcjogdGhpcy51c2luZ1JhdGVTdHlsZS5pdGVtQ29sb3JbMF0gfHwgIiMyNUJGRkYiCiAgICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgb2Zmc2V0OiAxLAogICAgICAgICAgICAgICAgY29sb3I6IHRoaXMudXNpbmdSYXRlU3R5bGUuaXRlbUNvbG9yWzFdIHx8ICIjNTI4NERFIgogICAgICAgICAgICAgIH1dKSwKICAgICAgICAgICAgICBzaGFkb3dCbHVyOiAxLAogICAgICAgICAgICAgIHNoYWRvd0NvbG9yOiB0aGlzLnVzaW5nUmF0ZVN0eWxlLml0ZW1Db2xvclsyXSB8fCAiIzJBOTVGOSIKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH1dCiAgICAgIH07CiAgICAgIC8vIOe7mOWItuWbvuihqAogICAgICBSaW5nR3JhcGguc2V0T3B0aW9uKG9wdGlvbik7CiAgICB9LAogICAgLy8g5Luq6KGo55uY5qC35byPLeminOiJsgogICAgZ2V0Q2lyY2xlQ29sb3IodXNpbmdSYXRlKSB7CiAgICAgIGlmICh1c2luZ1JhdGUgPCA2MCkgewogICAgICAgIHJldHVybiBOT1JNQUxfQ09MT1I7CiAgICAgIH0gZWxzZSBpZiAodXNpbmdSYXRlID4gNjAgJiYgdXNpbmdSYXRlIDwgODApIHsKICAgICAgICByZXR1cm4gV0FSTklOR19DT0xPUjsKICAgICAgfSBlbHNlIGlmICh1c2luZ1JhdGUgPiA4MCkgewogICAgICAgIHJldHVybiBEQU5HRVJfQ09MT1I7CiAgICAgIH0KICAgICAgcmV0dXJuIE5PUk1BTF9DT0xPUjsKICAgIH0sCiAgICBjaG9vc2VEaXNwbGF5SW5zdHJ1bWVudEJvYXJkRGF0YShpbmRleCkgewogICAgICB0aGlzLmN1cnJlbnRJbnN0cnVtZW50Qm9hcmREYXRhID0gdGhpcy5pbnN0cnVtZW50Qm9hcmREYXRhW2luZGV4XTsKICAgICAgdGhpcy5kcmF3QmFyKCk7CiAgICB9CiAgfQoKfTsK"},{"version":3,"sources":["InstrumentBoard.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+BA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA","file":"InstrumentBoard.vue","sourceRoot":"src/views/admin/monitor/server/components","sourcesContent":["<template>\n  <div class=\"instrument-board\">\n    <div v-if=\"showTopTitle && haveMultipleData\" class=\"instrument-board-title\">\n      <el-select\n        :value=\"topTitle\"\n        @change=\"chooseDisplayInstrumentBoardData\"\n      >\n        <el-option\n          v-for=\"(item,index) in instrumentBoardData\"\n          :key=\"index\"\n          :label=\"item.name || item['dir_name']\"\n          :value=\"index\"\n        />\n      </el-select>\n\n    </div>\n    <div v-else-if=\"showTopTitle\" class=\"instrument-board-title\">\n      {{ topTitle }}\n    </div>\n\n    <div :id=\"ringGraphId\" class=\"instrument-board-body\" />\n    <div\n      v-if=\"showSubTitle\"\n      class=\"instrument-board-subtitle\"\n      :title=\"subTitle.title\"\n    >{{ subTitle.content }}\n    </div>\n  </div>\n</template>\n\n<script>\nimport VueTypes from \"vue-types\";\n// 引入基本模板,按需加载\nconst echarts = require(\"echarts/lib/echarts\");\nrequire(\"echarts/lib/chart/gauge\");\n\n// 仪表盘颜色范围\nconst NORMAL_COLOR = {\n  color: \"#28BCFE\",\n  itemColor: [\"#25bfff\", \"#5284de\", \"#2a95f9\"]\n};\nconst WARNING_COLOR = {\n  color: \"#e6a23c\",\n  itemColor: [\"#e6a23c\", \"#cc8b1d\", \"#ffaf18\"]\n};\nconst DANGER_COLOR = {\n  color: \"#F56C6C\",\n  itemColor: [\"#fd666d\", \"#cf1717\", \"#b31212\"]\n};\n\nexport default {\n  name: \"InstrumentBoard\",\n  props: {\n    // 组件key\n    ringGraphKey: VueTypes.string.isRequired,\n    // 上标题\n    showTopTitle: VueTypes.bool.def(false),\n    // 下标题\n    showSubTitle: VueTypes.bool.def(false),\n    // top title 配置映射\n    topTitleKeyToNameMapping: VueTypes.object.def({\n      cpu: \"CPU使用率\",\n      memory: \"内存使用率\"\n    }),\n    instrumentBoardData: VueTypes.any.isRequired\n  },\n  data() {\n    return {\n      // 当前显示的数据\n      currentInstrumentBoardData: {}\n    };\n  },\n  computed: {\n    // 仪表盘是否存在多个数据\n    haveMultipleData() {\n      return this.instrumentBoardData instanceof Array && this.instrumentBoardData.length > 0;\n    },\n    // 使用率\n    ringRate() {\n      let ringRate = this.currentInstrumentBoardData.rate;\n      ringRate = ringRate < 1 ? ringRate * 100 : ringRate;\n      return parseFloat(ringRate.toFixed(4));\n    },\n    // 仪表盘id\n    ringGraphId() {\n      return `${this.ringGraphKey}UsingRate`;\n    },\n    // 上方标题\n    topTitle() {\n      return this.currentInstrumentBoardData[\"dir_name\"] || this.topTitleKeyToNameMapping[this.ringGraphKey] || this.ringGraphKey;\n    },\n    // 下方标题\n    subTitle() {\n      const used = this.currentInstrumentBoardData[\"used\"] ? this.currentInstrumentBoardData[\"used\"] + \"/\" : \"\";\n      const total = this.currentInstrumentBoardData[\"total\"] ? this.currentInstrumentBoardData[\"total\"] : \"\";\n      const unit = this.currentInstrumentBoardData[\"unit\"] ? ` (${this.currentInstrumentBoardData[\"unit\"]})` : \"\";\n      const content = `${used}${total}${unit} `;\n      const title = (this.currentInstrumentBoardData[\"used\"] ? \"已用/\" : \"\") + \"总量(单位)\";\n      return { content, title };\n    },\n    // 使用率样式配置\n    usingRateStyle() {\n      return {\n        fontSize: 18,\n        ...this.getCircleColor(this.ringRate)\n      };\n    }\n  },\n  mounted() {\n    if (this.haveMultipleData) {\n      this.currentInstrumentBoardData = this.instrumentBoardData[0];\n    } else {\n      this.currentInstrumentBoardData = this.instrumentBoardData;\n    }\n    this.drawBar();\n  },\n  methods: {\n    drawBar() {\n      const currentRate = [this.ringRate];\n      // 基于dom，初始化echarts实例\n      const RingGraph = echarts.init(document.getElementById(this.ringGraphId));\n\n      const option = {\n        title: {\n          text: currentRate + \"%\",\n          textStyle: this.usingRateStyle,\n          itemGap: 10,\n          left: \"center\",\n          top: \"45%\"\n        },\n        angleAxis: {\n          max: 100,\n          clockwise: true, // 逆时针\n          // 隐藏刻度线\n          show: false\n        },\n        radiusAxis: {\n          type: \"category\",\n          show: true,\n          axisLabel: {\n            show: false\n          },\n          axisLine: {\n            show: false\n          },\n          axisTick: {\n            show: false\n          }\n        },\n        polar: {\n          center: [\"50%\", \"50%\"], // 坐标中心位置\n          radius: \"100%\" // 图形大小\n        },\n        series: [{\n          type: \"bar\",\n          data: currentRate,\n          showBackground: true,\n          backgroundStyle: {\n            color: \"#BDEBFF\" // 底圈颜色\n          },\n          coordinateSystem: \"polar\",\n          roundCap: true,\n          barWidth: 15,\n          itemStyle: {\n            normal: {\n              opacity: 1,\n              color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{\n                offset: 0,\n                color: this.usingRateStyle.itemColor[0] || \"#25BFFF\"\n              }, {\n                offset: 1,\n                color: this.usingRateStyle.itemColor[1] || \"#5284DE\"\n              }]),\n              shadowBlur: 1,\n              shadowColor: this.usingRateStyle.itemColor[2] || \"#2A95F9\"\n            }\n          }\n        }]\n      };\n      // 绘制图表\n      RingGraph.setOption(option);\n    },\n    // 仪表盘样式-颜色\n    getCircleColor(usingRate) {\n      if (usingRate < 60) {\n        return NORMAL_COLOR;\n      } else if (usingRate > 60 && usingRate < 80) {\n        return WARNING_COLOR;\n      } else if (usingRate > 80) {\n        return DANGER_COLOR;\n      }\n      return NORMAL_COLOR;\n    },\n    chooseDisplayInstrumentBoardData(index) {\n      this.currentInstrumentBoardData = this.instrumentBoardData[index];\n      this.drawBar();\n    }\n  }\n\n};\n</script>\n\n<style scoped>\n.instrument-board-title {\n  font-weight: bolder;\n  text-align: center;\n}\n\n.instrument-board-body {\n  min-height: 200px;\n  min-width: 200px;\n}\n\n.instrument-board-subtitle {\n  text-align: center;\n}\n</style>\n"]}]}