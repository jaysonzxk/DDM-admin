{"remainingRequest":"/Users/jayson/Desktop/work/DDM-admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/jayson/Desktop/work/DDM-admin/src/views/admin/monitor/celery/crontab-task/edit-form-crontab-task.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/jayson/Desktop/work/DDM-admin/src/views/admin/monitor/celery/crontab-task/edit-form-crontab-task.vue","mtime":1720245294017},{"path":"/Users/jayson/Desktop/work/DDM-admin/node_modules/cache-loader/dist/cjs.js","mtime":1720245288376},{"path":"/Users/jayson/Desktop/work/DDM-admin/node_modules/babel-loader/lib/index.js","mtime":1720245285342},{"path":"/Users/jayson/Desktop/work/DDM-admin/node_modules/cache-loader/dist/cjs.js","mtime":1720245288376},{"path":"/Users/jayson/Desktop/work/DDM-admin/node_modules/vue-loader/lib/index.js","mtime":1720245293567}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCAqIGFzIFN5bmNEYXRhQXBpIGZyb20gIkAvYXBpL2FkbWluL21vbml0b3IvY2VsZXJ5IjsKZXhwb3J0IGRlZmF1bHQgewogIHByb3BzOiB7CiAgICBlbnRpdHk6IHsgdHlwZTogT2JqZWN0LCBkZWZhdWx0OiBudWxsIH0sCiAgICB2YWx1ZTogeyB0eXBlOiBCb29sZWFuLCBkZWZhdWx0OiBudWxsIH0sCiAgICBjcmVhdGU6IHsgdHlwZTogQm9vbGVhbiwgZGVmYXVsdDogZmFsc2UgfSwKICAgIHdpZHRoOiB7IHR5cGU6IFN0cmluZywgZGVmYXVsdDogIjUwJSIgfSwKICAgIHRhZ3M6IHsgdHlwZTogQXJyYXksIGRlZmF1bHQ6ICgpID0+IFtdIH0KICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBsb2FkaW5nOiBmYWxzZSwKICAgICAgZGlhbG9nVmlzaWJsZTogZmFsc2UsCiAgICAgIGZvcm06IHsKICAgICAgICBpbnN0YW5jZUlkOiAiIiwKICAgICAgICBtaW51dGU6ICIqIiwKICAgICAgICBob3VyOiAiKiIsCiAgICAgICAgZGF5X29mX3dlZWs6ICIqIiwKICAgICAgICBkYXlfb2ZfbW9udGg6ICIqIiwKICAgICAgICBtb250aF9vZl95ZWFyOiAiKiIKICAgICAgfQogICAgfTsKICB9LAogIGNvbXB1dGVkOiB7CiAgICBkaWFsb2dUaXRsZSgpIHsKICAgICAgcmV0dXJuIHRoaXMuY3JlYXRlID8gIuaWsOWinuS7u+WKoeWumuaXtiIgOiAi57yW6L6R5Lu75Yqh5a6a5pe2IjsKICAgIH0KICB9LAogIHdhdGNoOiB7CiAgICB2YWx1ZSh2YWwpIHsKICAgICAgdGhpcy5kaWFsb2dWaXNpYmxlID0gdmFsOwogICAgfSwKICAgIGRpYWxvZ1Zpc2libGUodmFsKSB7CiAgICAgIHRoaXMuJGVtaXQoImlucHV0IiwgdmFsKTsKICAgIH0KICB9LAogIGNyZWF0ZWQoKSB7CiAgfSwKICBtZXRob2RzOiB7CiAgICBkaWFsb2dPcGVuKCkgewogICAgICAvLyDkuLpUcnVl5oSP5ZGz552A5piv6YCa6L+H6YGN5Y+K5pa55byP5omT5byA5a+56K+d5qGGCiAgICAgIGlmICghdGhpcy5jcmVhdGUpIHsKICAgICAgICB0aGlzLmZvcm0gPSB7IC4uLnRoaXMuZW50aXR5IH07CiAgICAgIH0KICAgIH0sCiAgICBoYW5kbGVTdWJtaXQoKSB7CiAgICAgIHRoaXMuJHJlZnNbImZvcm0iXS52YWxpZGF0ZSgodmFsaWQpID0+IHsKICAgICAgICBpZiAodmFsaWQpIHsKICAgICAgICAgIHRoaXMubG9hZGluZyA9IHRydWU7CiAgICAgICAgICBjb25zdCBkYXRhID0geyAuLi50aGlzLmZvcm0gfTsKICAgICAgICAgIGNvbnNvbGUubG9nKHRoaXMuZm9ybSk7CiAgICAgICAgICBpZiAodGhpcy5jcmVhdGUpIHsKICAgICAgICAgICAgZGVsZXRlIGRhdGFbImluc3RhbmNlSWQiXTsKICAgICAgICAgICAgU3luY0RhdGFBcGkuY3JlYXRlQ3JvbnRhYlNjaGVkdWxlKGRhdGEpLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlOwogICAgICAgICAgICAgIHRoaXMuJGVtaXQoInN1Y2Nlc3MiLCByZXNwb25zZS5kYXRhKTsKICAgICAgICAgICAgICB0aGlzLmRpYWxvZ0Nsb3NlKCk7CiAgICAgICAgICAgICAgdGhpcy5tc2dTdWNjZXNzKCLmlrDlop7miJDlip8hIik7CiAgICAgICAgICAgIH0pLmNhdGNoKCgpID0+IHsKICAgICAgICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBTeW5jRGF0YUFwaS51cGRhdGVDcm9udGFiU2NoZWR1bGUoZGF0YSkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgICAgICAgdGhpcy4kZW1pdCgic3VjY2VzcyIsIHJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlOwogICAgICAgICAgICAgIHRoaXMubXNnU3VjY2Vzcygi5pu05paw5oiQ5YqfISIpOwogICAgICAgICAgICAgIHRoaXMuZGlhbG9nQ2xvc2UoKTsKICAgICAgICAgICAgfSkuY2F0Y2goKCkgPT4gewogICAgICAgICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgZGlhbG9nQ2xvc2UoKSB7CiAgICAgIHRoaXMuJHJlZnNbImZvcm0iXS5yZXNldEZpZWxkcygpOwogICAgICB0aGlzLiRwYXJlbnQuaW5pdERhdGEoKTsKICAgICAgdGhpcy5kaWFsb2dWaXNpYmxlID0gZmFsc2U7CiAgICB9CiAgfQp9Owo="},{"version":3,"sources":["edit-form-crontab-task.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"edit-form-crontab-task.vue","sourceRoot":"src/views/admin/monitor/celery/crontab-task","sourcesContent":["<!--\n@author: xuchi\n@description: 接口编辑组件\n-->\n<template>\n  <small-dialog\n    ref=\"dialog\"\n    v-model=\"dialogVisible\"\n    :dialog-title=\"dialogTitle\"\n    :width=\"width\"\n    icon=\"svg:icon-interface\"\n    @confirm=\"handleSubmit\"\n    @closed=\"dialogClose\"\n    @opened=\"dialogOpen\"\n  >\n    <el-form ref=\"form\" v-loading=\"loading\" :model=\"form\" :size=\"$ELEMENT.size\" label-width=\"120px\">\n      <el-form-item v-show=\"false\" prop=\"instanceId\" label=\"instanceId\" style=\"width: 200px;\">\n        <el-input v-model=\"form.instanceId\" readonly />\n      </el-form-item>\n      <el-form-item prop=\"minute\" label=\"分钟:\">\n        <el-input v-model=\"form.minute\" placeholder=\"默认: * \" />\n      </el-form-item>\n      <el-form-item prop=\"hour\" label=\"小时:\">\n        <el-input v-model=\"form.hour\" placeholder=\"默认: * \" />\n      </el-form-item>\n      <el-form-item prop=\"day_of_week\" label=\"每周的周几\">\n        <el-input v-model=\"form.day_of_week\" placeholder=\"默认: * \" />\n      </el-form-item>\n      <el-form-item prop=\"day_of_month\" label=\"每月的某天\">\n        <el-input v-model=\"form.day_of_month\" placeholder=\"默认: * \" />\n      </el-form-item>\n      <el-form-item prop=\"month_of_year\" label=\"每年的某月\">\n        <el-input v-model=\"form.month_of_year\" placeholder=\"默认: * \" />\n      </el-form-item>\n    </el-form>\n  </small-dialog>\n</template>\n<script>\nimport * as SyncDataApi from \"@/api/admin/monitor/celery\";\nexport default {\n  props: {\n    entity: { type: Object, default: null },\n    value: { type: Boolean, default: null },\n    create: { type: Boolean, default: false },\n    width: { type: String, default: \"50%\" },\n    tags: { type: Array, default: () => [] }\n  },\n  data() {\n    return {\n      loading: false,\n      dialogVisible: false,\n      form: {\n        instanceId: \"\",\n        minute: \"*\",\n        hour: \"*\",\n        day_of_week: \"*\",\n        day_of_month: \"*\",\n        month_of_year: \"*\"\n      }\n    };\n  },\n  computed: {\n    dialogTitle() {\n      return this.create ? \"新增任务定时\" : \"编辑任务定时\";\n    }\n  },\n  watch: {\n    value(val) {\n      this.dialogVisible = val;\n    },\n    dialogVisible(val) {\n      this.$emit(\"input\", val);\n    }\n  },\n  created() {\n  },\n  methods: {\n    dialogOpen() {\n      // 为True意味着是通过遍及方式打开对话框\n      if (!this.create) {\n        this.form = { ...this.entity };\n      }\n    },\n    handleSubmit() {\n      this.$refs[\"form\"].validate((valid) => {\n        if (valid) {\n          this.loading = true;\n          const data = { ...this.form };\n          console.log(this.form);\n          if (this.create) {\n            delete data[\"instanceId\"];\n            SyncDataApi.createCrontabSchedule(data).then(response => {\n              this.loading = false;\n              this.$emit(\"success\", response.data);\n              this.dialogClose();\n              this.msgSuccess(\"新增成功!\");\n            }).catch(() => {\n              this.loading = false;\n            });\n          } else {\n            SyncDataApi.updateCrontabSchedule(data).then(response => {\n              this.$emit(\"success\", response.data);\n              this.loading = false;\n              this.msgSuccess(\"更新成功!\");\n              this.dialogClose();\n            }).catch(() => {\n              this.loading = false;\n            });\n          }\n        } else {\n          return false;\n        }\n      });\n    },\n    dialogClose() {\n      this.$refs[\"form\"].resetFields();\n      this.$parent.initData();\n      this.dialogVisible = false;\n    }\n  }\n};\n</script>\n\n"]}]}