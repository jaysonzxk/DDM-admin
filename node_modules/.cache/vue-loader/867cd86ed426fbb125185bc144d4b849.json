{"remainingRequest":"/Users/jayson/Desktop/work/DDM-admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/jayson/Desktop/work/DDM-admin/src/components/HeaderSearch/index.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/jayson/Desktop/work/DDM-admin/src/components/HeaderSearch/index.vue","mtime":1720245294006},{"path":"/Users/jayson/Desktop/work/DDM-admin/node_modules/cache-loader/dist/cjs.js","mtime":1720245288376},{"path":"/Users/jayson/Desktop/work/DDM-admin/node_modules/babel-loader/lib/index.js","mtime":1720245285342},{"path":"/Users/jayson/Desktop/work/DDM-admin/node_modules/cache-loader/dist/cjs.js","mtime":1720245288376},{"path":"/Users/jayson/Desktop/work/DDM-admin/node_modules/vue-loader/lib/index.js","mtime":1720245293567}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCi8vIGZ1c2UgaXMgYSBsaWdodHdlaWdodCBmdXp6eS1zZWFyY2ggbW9kdWxlCi8vIG1ha2Ugc2VhcmNoIHJlc3VsdHMgbW9yZSBpbiBsaW5lIHdpdGggZXhwZWN0YXRpb25zCmltcG9ydCBGdXNlIGZyb20gImZ1c2UuanMvZGlzdC9mdXNlLm1pbi5qcyI7CmltcG9ydCBwYXRoIGZyb20gInBhdGgiOwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJIZWFkZXJTZWFyY2giLAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBzZWFyY2g6ICIiLAogICAgICBvcHRpb25zOiBbXSwKICAgICAgc2VhcmNoUG9vbDogW10sCiAgICAgIHNob3c6IGZhbHNlLAogICAgICBmdXNlOiB1bmRlZmluZWQKICAgIH07CiAgfSwKICBjb21wdXRlZDogewogICAgcm91dGVzKCkgewogICAgICByZXR1cm4gdGhpcy4kc3RvcmUuZ2V0dGVycy5wZXJtaXNzaW9uX3JvdXRlczsKICAgIH0KICB9LAogIHdhdGNoOiB7CiAgICByb3V0ZXMoKSB7CiAgICAgIHRoaXMuc2VhcmNoUG9vbCA9IHRoaXMuZ2VuZXJhdGVSb3V0ZXModGhpcy5yb3V0ZXMpOwogICAgfSwKICAgIHNlYXJjaFBvb2wobGlzdCkgewogICAgICB0aGlzLmluaXRGdXNlKGxpc3QpOwogICAgfSwKICAgIHNob3codmFsdWUpIHsKICAgICAgaWYgKHZhbHVlKSB7CiAgICAgICAgZG9jdW1lbnQuYm9keS5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsIHRoaXMuY2xvc2UpOwogICAgICB9IGVsc2UgewogICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlRXZlbnRMaXN0ZW5lcigiY2xpY2siLCB0aGlzLmNsb3NlKTsKICAgICAgfQogICAgfQogIH0sCiAgbW91bnRlZCgpIHsKICAgIHRoaXMuc2VhcmNoUG9vbCA9IHRoaXMuZ2VuZXJhdGVSb3V0ZXModGhpcy5yb3V0ZXMpOwogIH0sCiAgbWV0aG9kczogewogICAgY2xpY2soKSB7CiAgICAgIHRoaXMuc2hvdyA9ICF0aGlzLnNob3c7CiAgICAgIGlmICh0aGlzLnNob3cpIHsKICAgICAgICB0aGlzLiRyZWZzLmhlYWRlclNlYXJjaFNlbGVjdCAmJiB0aGlzLiRyZWZzLmhlYWRlclNlYXJjaFNlbGVjdC5mb2N1cygpOwogICAgICB9CiAgICB9LAogICAgY2xvc2UoKSB7CiAgICAgIHRoaXMuJHJlZnMuaGVhZGVyU2VhcmNoU2VsZWN0ICYmIHRoaXMuJHJlZnMuaGVhZGVyU2VhcmNoU2VsZWN0LmJsdXIoKTsKICAgICAgdGhpcy5vcHRpb25zID0gW107CiAgICAgIHRoaXMuc2hvdyA9IGZhbHNlOwogICAgfSwKICAgIGNoYW5nZSh2YWwpIHsKICAgICAgaWYgKHRoaXMuaXNodHRwKHZhbC5wYXRoKSkgewogICAgICAgIC8vIGh0dHAocyk6Ly8g6Lev5b6E5paw56qX5Y+j5omT5byACiAgICAgICAgd2luZG93Lm9wZW4odmFsLnBhdGgsICJfYmxhbmsiKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCh2YWwucGF0aCk7CiAgICAgIH0KICAgICAgdGhpcy5zZWFyY2ggPSAiIjsKICAgICAgdGhpcy5vcHRpb25zID0gW107CiAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsKICAgICAgICB0aGlzLnNob3cgPSBmYWxzZTsKICAgICAgfSk7CiAgICB9LAogICAgaW5pdEZ1c2UobGlzdCkgewogICAgICB0aGlzLmZ1c2UgPSBuZXcgRnVzZShsaXN0LCB7CiAgICAgICAgc2hvdWxkU29ydDogdHJ1ZSwKICAgICAgICB0aHJlc2hvbGQ6IDAuNCwKICAgICAgICBsb2NhdGlvbjogMCwKICAgICAgICBkaXN0YW5jZTogMTAwLAogICAgICAgIG1heFBhdHRlcm5MZW5ndGg6IDMyLAogICAgICAgIG1pbk1hdGNoQ2hhckxlbmd0aDogMSwKICAgICAgICBrZXlzOiBbewogICAgICAgICAgbmFtZTogInRpdGxlIiwKICAgICAgICAgIHdlaWdodDogMC43CiAgICAgICAgfSwgewogICAgICAgICAgbmFtZTogInBhdGgiLAogICAgICAgICAgd2VpZ2h0OiAwLjMKICAgICAgICB9XQogICAgICB9KTsKICAgIH0sCiAgICAvLyBGaWx0ZXIgb3V0IHRoZSByb3V0ZXMgdGhhdCBjYW4gYmUgZGlzcGxheWVkIGluIHRoZSBzaWRlYmFyCiAgICAvLyBBbmQgZ2VuZXJhdGUgdGhlIGludGVybmF0aW9uYWxpemVkIHRpdGxlCiAgICBnZW5lcmF0ZVJvdXRlcyhyb3V0ZXMsIGJhc2VQYXRoID0gIi8iLCBwcmVmaXhUaXRsZSA9IFtdKSB7CiAgICAgIGxldCByZXMgPSBbXTsKCiAgICAgIGZvciAoY29uc3Qgcm91dGVyIG9mIHJvdXRlcykgewogICAgICAgIC8vIHNraXAgaGlkZGVuIHJvdXRlcgogICAgICAgIGlmIChyb3V0ZXIuaGlkZGVuKSB7IGNvbnRpbnVlOyB9CgogICAgICAgIGNvbnN0IGRhdGEgPSB7CiAgICAgICAgICBwYXRoOiAhdGhpcy5pc2h0dHAocm91dGVyLnBhdGgpID8gcGF0aC5yZXNvbHZlKGJhc2VQYXRoLCByb3V0ZXIucGF0aCkgOiByb3V0ZXIucGF0aCwKICAgICAgICAgIHRpdGxlOiBbLi4ucHJlZml4VGl0bGVdCiAgICAgICAgfTsKCiAgICAgICAgaWYgKHJvdXRlci5tZXRhICYmIHJvdXRlci5tZXRhLnRpdGxlKSB7CiAgICAgICAgICBkYXRhLnRpdGxlID0gWy4uLmRhdGEudGl0bGUsIHJvdXRlci5tZXRhLnRpdGxlXTsKCiAgICAgICAgICBpZiAocm91dGVyLnJlZGlyZWN0ICE9PSAibm9SZWRpcmVjdCIpIHsKICAgICAgICAgICAgLy8gb25seSBwdXNoIHRoZSByb3V0ZXMgd2l0aCB0aXRsZQogICAgICAgICAgICAvLyBzcGVjaWFsIGNhc2U6IG5lZWQgdG8gZXhjbHVkZSBwYXJlbnQgcm91dGVyIHdpdGhvdXQgcmVkaXJlY3QKICAgICAgICAgICAgcmVzLnB1c2goZGF0YSk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvLyByZWN1cnNpdmUgY2hpbGQgcm91dGVzCiAgICAgICAgaWYgKHJvdXRlci5jaGlsZHJlbikgewogICAgICAgICAgY29uc3QgdGVtcFJvdXRlcyA9IHRoaXMuZ2VuZXJhdGVSb3V0ZXMocm91dGVyLmNoaWxkcmVuLCBkYXRhLnBhdGgsIGRhdGEudGl0bGUpOwogICAgICAgICAgaWYgKHRlbXBSb3V0ZXMubGVuZ3RoID49IDEpIHsKICAgICAgICAgICAgcmVzID0gWy4uLnJlcywgLi4udGVtcFJvdXRlc107CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiByZXM7CiAgICB9LAogICAgcXVlcnlTZWFyY2gocXVlcnkpIHsKICAgICAgaWYgKHF1ZXJ5ICE9PSAiIikgewogICAgICAgIHRoaXMub3B0aW9ucyA9IHRoaXMuZnVzZS5zZWFyY2gocXVlcnkpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMub3B0aW9ucyA9IFtdOwogICAgICB9CiAgICB9LAogICAgaXNodHRwKHVybCkgewogICAgICByZXR1cm4gdXJsLmluZGV4T2YoImh0dHA6Ly8iKSAhPT0gLTEgfHwgdXJsLmluZGV4T2YoImh0dHBzOi8vIikgIT09IC0xOwogICAgfQogIH0KfTsK"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;AAoBA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/components/HeaderSearch","sourcesContent":["<template>\n  <div :class=\"{'show':show}\" class=\"header-search\">\n    <svg-icon class-name=\"search-icon\" icon-class=\"search\" @click.stop=\"click\" />\n    <el-select\n      ref=\"headerSearchSelect\"\n      v-model=\"search\"\n      :remote-method=\"querySearch\"\n      filterable\n      default-first-option\n      remote\n      placeholder=\"Search\"\n      class=\"header-search-select\"\n      @change=\"change\"\n    >\n      <el-option v-for=\"option in options\" :key=\"option.item.path\" :value=\"option.item\" :label=\"option.item.title.join(' > ')\" />\n    </el-select>\n  </div>\n</template>\n\n<script>\n// fuse is a lightweight fuzzy-search module\n// make search results more in line with expectations\nimport Fuse from \"fuse.js/dist/fuse.min.js\";\nimport path from \"path\";\n\nexport default {\n  name: \"HeaderSearch\",\n  data() {\n    return {\n      search: \"\",\n      options: [],\n      searchPool: [],\n      show: false,\n      fuse: undefined\n    };\n  },\n  computed: {\n    routes() {\n      return this.$store.getters.permission_routes;\n    }\n  },\n  watch: {\n    routes() {\n      this.searchPool = this.generateRoutes(this.routes);\n    },\n    searchPool(list) {\n      this.initFuse(list);\n    },\n    show(value) {\n      if (value) {\n        document.body.addEventListener(\"click\", this.close);\n      } else {\n        document.body.removeEventListener(\"click\", this.close);\n      }\n    }\n  },\n  mounted() {\n    this.searchPool = this.generateRoutes(this.routes);\n  },\n  methods: {\n    click() {\n      this.show = !this.show;\n      if (this.show) {\n        this.$refs.headerSearchSelect && this.$refs.headerSearchSelect.focus();\n      }\n    },\n    close() {\n      this.$refs.headerSearchSelect && this.$refs.headerSearchSelect.blur();\n      this.options = [];\n      this.show = false;\n    },\n    change(val) {\n      if (this.ishttp(val.path)) {\n        // http(s):// 路径新窗口打开\n        window.open(val.path, \"_blank\");\n      } else {\n        this.$router.push(val.path);\n      }\n      this.search = \"\";\n      this.options = [];\n      this.$nextTick(() => {\n        this.show = false;\n      });\n    },\n    initFuse(list) {\n      this.fuse = new Fuse(list, {\n        shouldSort: true,\n        threshold: 0.4,\n        location: 0,\n        distance: 100,\n        maxPatternLength: 32,\n        minMatchCharLength: 1,\n        keys: [{\n          name: \"title\",\n          weight: 0.7\n        }, {\n          name: \"path\",\n          weight: 0.3\n        }]\n      });\n    },\n    // Filter out the routes that can be displayed in the sidebar\n    // And generate the internationalized title\n    generateRoutes(routes, basePath = \"/\", prefixTitle = []) {\n      let res = [];\n\n      for (const router of routes) {\n        // skip hidden router\n        if (router.hidden) { continue; }\n\n        const data = {\n          path: !this.ishttp(router.path) ? path.resolve(basePath, router.path) : router.path,\n          title: [...prefixTitle]\n        };\n\n        if (router.meta && router.meta.title) {\n          data.title = [...data.title, router.meta.title];\n\n          if (router.redirect !== \"noRedirect\") {\n            // only push the routes with title\n            // special case: need to exclude parent router without redirect\n            res.push(data);\n          }\n        }\n\n        // recursive child routes\n        if (router.children) {\n          const tempRoutes = this.generateRoutes(router.children, data.path, data.title);\n          if (tempRoutes.length >= 1) {\n            res = [...res, ...tempRoutes];\n          }\n        }\n      }\n      return res;\n    },\n    querySearch(query) {\n      if (query !== \"\") {\n        this.options = this.fuse.search(query);\n      } else {\n        this.options = [];\n      }\n    },\n    ishttp(url) {\n      return url.indexOf(\"http://\") !== -1 || url.indexOf(\"https://\") !== -1;\n    }\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.header-search {\n  font-size: 0 !important;\n\n  .search-icon {\n    cursor: pointer;\n    font-size: 18px;\n    vertical-align: middle;\n  }\n\n  .header-search-select {\n    font-size: 18px;\n    transition: width 0.2s;\n    width: 0;\n    overflow: hidden;\n    background: transparent;\n    border-radius: 0;\n    display: inline-block;\n    vertical-align: middle;\n\n    ::v-deep .el-input__inner {\n      border-radius: 0;\n      border: 0;\n      padding-left: 0;\n      padding-right: 0;\n      box-shadow: none !important;\n      border-bottom: 1px solid #d9d9d9;\n      vertical-align: middle;\n    }\n  }\n\n  &.show {\n    .header-search-select {\n      width: 210px;\n      margin-left: 10px;\n    }\n  }\n}\n</style>\n"]}]}