{"remainingRequest":"/Users/mac/Desktop/DDM-admin/node_modules/babel-loader/lib/index.js!/Users/mac/Desktop/DDM-admin/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/mac/Desktop/DDM-admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/mac/Desktop/DDM-admin/src/views/admin/system/message/Mymessage.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/mac/Desktop/DDM-admin/src/views/admin/system/message/Mymessage.vue","mtime":1702065174000},{"path":"/Users/mac/Desktop/DDM-admin/babel.config.js","mtime":1702065174000},{"path":"/Users/mac/Desktop/DDM-admin/node_modules/cache-loader/dist/cjs.js","mtime":1703645363792},{"path":"/Users/mac/Desktop/DDM-admin/node_modules/babel-loader/lib/index.js","mtime":1703645364828},{"path":"/Users/mac/Desktop/DDM-admin/node_modules/cache-loader/dist/cjs.js","mtime":1703645363792},{"path":"/Users/mac/Desktop/DDM-admin/node_modules/vue-loader/lib/index.js","mtime":1703645365038}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKdmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKCIvVXNlcnMvbWFjL0Rlc2t0b3AvRERNLWFkbWluL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2ludGVyb3BSZXF1aXJlRGVmYXVsdC5qcyIpLmRlZmF1bHQ7Ck9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwOwp2YXIgX29iamVjdFNwcmVhZDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIi9Vc2Vycy9tYWMvRGVza3RvcC9ERE0tYWRtaW4vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvb2JqZWN0U3ByZWFkMi5qcyIpKTsKdmFyIF9tZXNzYWdlID0gcmVxdWlyZSgiQC9hcGkvYWRtaW4vc3lzdGVtL21lc3NhZ2UiKTsKdmFyIF9zdG9yZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgiQC9zdG9yZSIpKTsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KdmFyIF9kZWZhdWx0ID0gZXhwb3J0cy5kZWZhdWx0ID0gewogIG5hbWU6ICJNeW1lc3NhZ2UiLAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICAvLyDmn6Xor6LpgJrnn6UKICAgICAgcXVlcnlQYXJhbXM6IHsKICAgICAgICBwYWdlTnVtOiAxLAogICAgICAgIHBhZ2VTaXplOiAxMAogICAgICB9LAogICAgICBtZXNzYWdlTGlzdDogW10sCiAgICAgIC8vIOW3suivu+mAmuefpQogICAgICBjb3VudFJlYWRlZDogMCwKICAgICAgbWVzc2FnZVJlYWRlZExpc3Q6IFtdLAogICAgICAvLyDmnKror7vmtojmga/liJfooagKICAgICAgbWVzc2FnZVVucmVhZExpc3Q6IFtdLAogICAgICBjb3VudFVucmVhZDogMCwKICAgICAgYmFkZ2VUeXBlOiAiZGFuZ2VyIiwKICAgICAgLy8g6YCJ5Lit5p+l6K+i5ZCO55qE6K+m57uG5L+h5oGvCiAgICAgIHNob3dpbmdNc2dJdGVtOiB7fQogICAgfTsKICB9LAogIGNyZWF0ZWQ6IGZ1bmN0aW9uIGNyZWF0ZWQoKSB7CiAgICB0aGlzLmdldExpc3QoKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIC8qKiDmn6Xor6LpgJrnn6XliJfooaggKi9nZXRMaXN0OiBmdW5jdGlvbiBnZXRMaXN0KCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICAvLyDlt7Lor7vpgJrnn6XliJfooagKICAgICAgKDAsIF9tZXNzYWdlLnVzZXJNZXNzYWdlKSh0aGlzLmFkZERhdGVSYW5nZSgoMCwgX29iamVjdFNwcmVhZDIuZGVmYXVsdCkoKDAsIF9vYmplY3RTcHJlYWQyLmRlZmF1bHQpKHt9LCB0aGlzLnF1ZXJ5UGFyYW1zKSwge30sIHsKICAgICAgICBpc19yZWFkOiAiVHJ1ZSIKICAgICAgfSkpKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIF90aGlzLm1lc3NhZ2VSZWFkZWRMaXN0ID0gcmVzcG9uc2UuZGF0YS5yZXN1bHRzOwogICAgICAgIF90aGlzLmNvdW50UmVhZGVkID0gcmVzcG9uc2UuZGF0YS5jb3VudDsKICAgICAgfSk7CiAgICAgIC8vIOacquivu+mAmuefpeWIl+ihqAogICAgICAoMCwgX21lc3NhZ2UudXNlck1lc3NhZ2UpKHRoaXMuYWRkRGF0ZVJhbmdlKCgwLCBfb2JqZWN0U3ByZWFkMi5kZWZhdWx0KSgoMCwgX29iamVjdFNwcmVhZDIuZGVmYXVsdCkoe30sIHRoaXMucXVlcnlQYXJhbXMpLCB7fSwgewogICAgICAgIGlzX3JlYWQ6ICJGYWxzZSIKICAgICAgfSkpKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIF90aGlzLm1lc3NhZ2VVbnJlYWRMaXN0ID0gcmVzcG9uc2UuZGF0YS5yZXN1bHRzOwogICAgICAgIF90aGlzLmNvdW50VW5yZWFkID0gcmVzcG9uc2UuZGF0YS5jb3VudDsKICAgICAgICBfdGhpcy5tZXNzYWdlTGlzdCA9IF90aGlzLm1lc3NhZ2VVbnJlYWRMaXN0OwogICAgICB9KTsKICAgIH0sCiAgICBoYW5kbGVTZWxlY3Q6IGZ1bmN0aW9uIGhhbmRsZVNlbGVjdChrZXksIGtleVBhdGgpIHsKICAgICAgdGhpcy5tZXNzYWdlTGlzdCA9IGtleVswXSA9PT0gIjEiID8gdGhpcy5tZXNzYWdlVW5yZWFkTGlzdCA6IHRoaXMubWVzc2FnZVJlYWRlZExpc3Q7CiAgICAgIHRoaXMuYmFkZ2VUeXBlID0ga2V5WzBdID09PSAiMSIgPyAiZGFuZ2VyIiA6ICJpbmZvIjsKICAgIH0sCiAgICAvLyDpgJrnn6XliJfooajmv4DmtLvlkI4KICAgIGhhbmRsZUxpc3RTZWxlY3Q6IGZ1bmN0aW9uIGhhbmRsZUxpc3RTZWxlY3Qoa2V5LCBrZXlQYXRoKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwogICAgICB0aGlzLnNob3dpbmdNc2dJdGVtID0gdGhpcy5tZXNzYWdlTGlzdFtrZXlbMF1dOwogICAgICAvLyDkv67mlLnpgJrnn6Xmn6Xor6LnirbmgIEKICAgICAgaWYgKHRoaXMuYmFkZ2VUeXBlID09PSAiZGFuZ2VyIikgewogICAgICAgICgwLCBfbWVzc2FnZS51cGRhdGVJc1JlYWQpKHRoaXMuc2hvd2luZ01zZ0l0ZW0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICBpZiAocmVzcG9uc2UuY29kZSA9PT0gMjAwKSB7CiAgICAgICAgICAgIF9zdG9yZS5kZWZhdWx0LmNvbW1pdCgiU0VUX1VOUkVBRF9NU0dfQ09VTlQiLCBfc3RvcmUuZGVmYXVsdC5nZXR0ZXJzLnVucmVhZF9tc2dfY291bnQgLSAxKTsKICAgICAgICAgICAgX3RoaXMyLm9wZW4gPSBmYWxzZTsKICAgICAgICAgICAgX3RoaXMyLmdldExpc3QoKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQogICAgfQogIH0KfTs="},{"version":3,"names":["_message","require","_store","_interopRequireDefault","name","data","queryParams","pageNum","pageSize","messageList","countReaded","messageReadedList","messageUnreadList","countUnread","badgeType","showingMsgItem","created","getList","methods","_this","userMessage","addDateRange","_objectSpread2","default","is_read","then","response","results","count","handleSelect","key","keyPath","handleListSelect","_this2","updateIsRead","code","store","commit","getters","unread_msg_count","open"],"sources":["src/views/admin/system/message/Mymessage.vue"],"sourcesContent":["<template>\n  <div class=\"app-container\">\n    <el-card shadow=\"never\">\n      <div class=\"message-page-con message-category-con\">\n        <el-menu\n          default-active=\"1\"\n          class=\"el-menu-vertical-demo\"\n          @select=\"handleSelect\"\n        >\n          <el-menu-item index=\"1\">\n            <template slot=\"title\">\n              <span class=\"category-title\">未读消息</span>\n              <el-badge style=\"margin-bottom: 3px\" :value=\"countUnread\" :hidden=\"countUnread===0\" />\n            </template>\n          </el-menu-item>\n          <el-menu-item index=\"2\">\n            <span class=\"category-title\">已读消息</span>\n            <el-badge style=\"margin-bottom: 3px\" type=\"info\" :value=\"countReaded\" />\n          </el-menu-item>\n        </el-menu>\n      </div>\n      <div class=\"message-page-con message-list-con\">\n        <el-menu\n          default-active=\"2\"\n          class=\"el-menu-vertical-demo\"\n          @select=\"handleListSelect\"\n        >\n          <el-menu-item v-for=\"(item,index) in messageList\" :key=\"index\" :index=\"index.toString()\">\n            <template slot=\"title\">\n              <div style=\"line-height: 10px!important;height: 20px;\">\n                <p class=\"msg-title\">{{ item.title }}</p>\n                <el-badge is-dot class=\"item\" :type=\"badgeType\" />\n                {{ item.create_datetime }}\n\n              </div>\n            </template>\n          </el-menu-item>\n        </el-menu>\n      </div>\n      <div class=\"message-page-con message-view-con\">\n        <div class=\"message-view-header\">\n          <h2 class=\"message-view-title\">{{ showingMsgItem.title }}</h2>\n          <time class=\"message-view-time\">{{ showingMsgItem.create_datetime }}</time>\n        </div>\n        <div v-html=\"showingMsgItem.content\" />\n      </div>\n    </el-card>\n  </div>\n</template>\n\n<script>\nimport { updateIsRead, userMessage } from \"@/api/admin/system/message\";\nimport store from \"@/store\";\n\nexport default {\n  name: \"Mymessage\",\n  data() {\n    return {\n      // 查询通知\n      queryParams: {\n        pageNum: 1,\n        pageSize: 10\n      },\n      messageList: [],\n      // 已读通知\n      countReaded: 0,\n      messageReadedList: [],\n      // 未读消息列表\n      messageUnreadList: [],\n      countUnread: 0,\n      badgeType: \"danger\",\n      // 选中查询后的详细信息\n      showingMsgItem: {}\n    };\n  },\n  created() {\n    this.getList();\n  },\n  methods: {\n    /** 查询通知列表 */\n    getList() {\n      // 已读通知列表\n      userMessage(this.addDateRange({ ...this.queryParams, is_read: \"True\" })).then(response => {\n        this.messageReadedList = response.data.results;\n        this.countReaded = response.data.count;\n      }\n      );\n      // 未读通知列表\n      userMessage(this.addDateRange({ ...this.queryParams, is_read: \"False\" })).then(response => {\n        this.messageUnreadList = response.data.results;\n        this.countUnread = response.data.count;\n        this.messageList = this.messageUnreadList;\n      }\n      );\n    },\n    handleSelect(key, keyPath) {\n      this.messageList = key[0] === \"1\" ? this.messageUnreadList : this.messageReadedList;\n      this.badgeType = key[0] === \"1\" ? \"danger\" : \"info\";\n    },\n    // 通知列表激活后\n    handleListSelect(key, keyPath) {\n      this.showingMsgItem = this.messageList[key[0]];\n      // 修改通知查询状态\n      if (this.badgeType === \"danger\") {\n        updateIsRead(this.showingMsgItem).then(response => {\n          if (response.code === 200) {\n            store.commit(\"SET_UNREAD_MSG_COUNT\", store.getters.unread_msg_count - 1);\n            this.open = false;\n            this.getList();\n          }\n        });\n      }\n    }\n  }\n};\n</script>\n<style scoped>\n  .app-container {\n    background-color: #f5f7f9;\n  }\n\n  .message-category-con {\n    border-right: 1px solid #e6e6e6;\n    width: 200px;\n  }\n\n  .message-page-con {\n    height: calc(100vh - 176px);\n    display: inline-block;\n    vertical-align: top;\n    position: relative;\n  }\n\n  .category-title {\n    display: inline-block;\n    width: 65px;\n  }\n\n  .message-list-con {\n    border-right: 1px solid #e6e6e6;\n    width: 230px;\n  }\n\n  .msg-title {\n    word-break: break-all;\n    white-space: normal;\n    line-height: 15px;\n    color: rgb(170, 169, 169);\n  }\n\n  .message-list-con .el-menu-item {\n    height: 80px;\n    padding-top: 5px;\n  }\n\n  .item {\n    margin-right: 10px;\n    margin-bottom: 5px;\n  }\n\n  .message-view-con {\n    position: absolute;\n    left: 486px;\n    top: 16px;\n    right: 16px;\n    bottom: 16px;\n    overflow: auto;\n    padding: 12px 20px 0;\n\n  }\n\n  .message-view-header {\n    margin-bottom: 20px;\n\n  }\n\n  .message-view-title {\n    display: inline-block;\n  }\n\n  .message-view-time {\n    margin-left: 20px;\n  }\n</style>\n"],"mappings":";;;;;;;;AAmDA,IAAAA,QAAA,GAAAC,OAAA;AACA,IAAAC,MAAA,GAAAC,sBAAA,CAAAF,OAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;iCAEA;EACAG,IAAA;EACAC,IAAA,WAAAA,KAAA;IACA;MACA;MACAC,WAAA;QACAC,OAAA;QACAC,QAAA;MACA;MACAC,WAAA;MACA;MACAC,WAAA;MACAC,iBAAA;MACA;MACAC,iBAAA;MACAC,WAAA;MACAC,SAAA;MACA;MACAC,cAAA;IACA;EACA;EACAC,OAAA,WAAAA,QAAA;IACA,KAAAC,OAAA;EACA;EACAC,OAAA;IACA,aACAD,OAAA,WAAAA,QAAA;MAAA,IAAAE,KAAA;MACA;MACA,IAAAC,oBAAA,OAAAC,YAAA,KAAAC,cAAA,CAAAC,OAAA,MAAAD,cAAA,CAAAC,OAAA,WAAAjB,WAAA;QAAAkB,OAAA;MAAA,KAAAC,IAAA,WAAAC,QAAA;QACAP,KAAA,CAAAR,iBAAA,GAAAe,QAAA,CAAArB,IAAA,CAAAsB,OAAA;QACAR,KAAA,CAAAT,WAAA,GAAAgB,QAAA,CAAArB,IAAA,CAAAuB,KAAA;MACA,CACA;MACA;MACA,IAAAR,oBAAA,OAAAC,YAAA,KAAAC,cAAA,CAAAC,OAAA,MAAAD,cAAA,CAAAC,OAAA,WAAAjB,WAAA;QAAAkB,OAAA;MAAA,KAAAC,IAAA,WAAAC,QAAA;QACAP,KAAA,CAAAP,iBAAA,GAAAc,QAAA,CAAArB,IAAA,CAAAsB,OAAA;QACAR,KAAA,CAAAN,WAAA,GAAAa,QAAA,CAAArB,IAAA,CAAAuB,KAAA;QACAT,KAAA,CAAAV,WAAA,GAAAU,KAAA,CAAAP,iBAAA;MACA,CACA;IACA;IACAiB,YAAA,WAAAA,aAAAC,GAAA,EAAAC,OAAA;MACA,KAAAtB,WAAA,GAAAqB,GAAA,mBAAAlB,iBAAA,QAAAD,iBAAA;MACA,KAAAG,SAAA,GAAAgB,GAAA;IACA;IACA;IACAE,gBAAA,WAAAA,iBAAAF,GAAA,EAAAC,OAAA;MAAA,IAAAE,MAAA;MACA,KAAAlB,cAAA,QAAAN,WAAA,CAAAqB,GAAA;MACA;MACA,SAAAhB,SAAA;QACA,IAAAoB,qBAAA,OAAAnB,cAAA,EAAAU,IAAA,WAAAC,QAAA;UACA,IAAAA,QAAA,CAAAS,IAAA;YACAC,cAAA,CAAAC,MAAA,yBAAAD,cAAA,CAAAE,OAAA,CAAAC,gBAAA;YACAN,MAAA,CAAAO,IAAA;YACAP,MAAA,CAAAhB,OAAA;UACA;QACA;MACA;IACA;EACA;AACA"}]}